# 箱线图修改说明：G1 vs G4 对比

## 📋 修改概述

**修改日期**: 2025-12-06
**修改内容**: 箱线图由显示4个组 (G1, G2, G3, G4) 改为仅显示2个组 (G1, G4)
**修改原因**: 聚焦于提出方法与传统基线的直接对比,避免中间状态干扰视觉判断

---

## 🔄 修改前后对比

### 修改前

**显示组别**: G1, G2, G3, G4 (4个箱体)

**问题**:
- 视觉上有4个箱体,对比不够直观
- G2和G3作为半优化方案,干扰了读者对核心对比的理解
- 图表信息密度高,不利于快速传达核心结论

**适用场景**: 学术论文的详细对比分析章节

---

### 修改后

**显示组别**: G1 (Proposed), G4 (Baseline) (2个箱体)

**优势**:
- ✅ **视觉清晰**: 绿色(G1)与红色(G4)的直接对比
- ✅ **核心突出**: 聚焦于"我们的方法 vs 传统方法"
- ✅ **量化改进**: 顶部显示能耗降低百分比
- ✅ **统计显著**: G1和G4差异最大,notch不重叠更明显

**适用场景**: 论文摘要图、海报、演讲PPT

---

## 📊 修改的图表元素

### 1. 对比组别

```diff
- groups = ['G1', 'G2', 'G3', 'G4']
+ groups = ['G1', 'G4']  # 只对比G1和G4
```

### 2. 标签说明

```diff
- labels = ['G1', 'G2', 'G3', 'G4']
+ labels = ['G1\n(Proposed)', 'G4\n(Baseline)']
```

**新增标签**:
- G1下方显示 "(Proposed)" - 提出方法
- G4下方显示 "(Baseline)" - 传统基线

### 3. 图表标题

```diff
- 'System Energy Distribution Comparison'
+ 'System Energy Distribution: Proposed (G1) vs Baseline (G4)'
```

### 4. 新增改进率显示 ⭐

**位置**: 图表顶部居中

**内容**: 绿色文本框显示能耗降低百分比

```python
improvement = (G4_median - G1_median) / G4_median * 100
显示文本: f'Energy Reduction: {improvement:.2f}%'
```

**样式**:
- 背景色: 浅绿色 (lightgreen)
- 边框色: 绿色 (green)
- 字体: 14号加粗
- 位置: transform=ax.transAxes, (0.5, 0.98)

### 5. 箱体样式调整

```diff
- widths = 0.5 (默认)
+ widths = 0.6  # 增加箱体宽度,更醒目

- alpha = 0.7
+ alpha = 0.8  # 增加不透明度,颜色更鲜明
```

### 6. 中位数标注增强

**旧版**:
- 白色背景
- 无边框
- 字体10号

**新版**:
- 白色背景
- **有颜色边框** (绿色/红色,对应组别)
- **字体12号加粗**
- 边框宽度2px

### 7. 统计信息打印格式

**旧版**:
```
G1: 中位数=67250J, 均值=67252J, ...
G2: ...
G3: ...
G4: ...
```

**新版**:
```
Proposed (G1):
  中位数=67250.12J, 均值=67252.45J, 标准差=1.85J
  最小值=67248.89J, 最大值=67254.11J, 数据点数=3

Baseline (G4):
  中位数=68050.34J, 均值=68055.67J, 标准差=3.21J
  最小值=68047.23J, 最大值=68059.12J, 数据点数=3

[性能改进]
  能耗降低: 1.18%
  绝对节省: 800.22J
```

---

## 📁 修改的文件

### 1. 绘图脚本

**文件**: `端到端/对比实验/plot_boxplots_only.py`

**主要修改**:
- `plot_distribution_boxplots()` 函数
  - 第39行: `groups = ['G1', 'G4']`
  - 第40行: 添加标签说明
  - 第85-90行: 新增改进率计算和显示
  - 第103-118行: 更新统计信息打印格式

### 2. 实验设计文档

**文件**: `端到端/文档报告/箱线图实验设计说明.md`

**主要修改**:
- 第11行: 添加"对比组别: G1 vs G4"
- 第53-64行: 更新对照组表格,增加"箱线图显示"列
- 第60-64行: 添加箱线图选择理由
- 第104行: 更新实验矩阵说明
- 第109-119行: 更新数据点表格,增加"箱线图"列
- 第279-312行: 更新预期结果说明

---

## 🎨 视觉效果对比

### 颜色方案

| 组别 | 颜色 | 颜色代码 | 含义 |
|------|------|---------|------|
| G1 | 绿色 | #2ECC71 | 提出方法(最优) |
| G4 | 红色 | #E74C3C | 传统基线(最差) |

**对比效果**: 绿色表示"好/优",红色表示"差/基线",符合直觉认知

### 图表布局

```
┌────────────────────────────────────────────────┐
│  System Energy Distribution: G1 vs G4         │
│  ┌──────────────────────────────┐             │
│  │ Energy Reduction: 1.18%      │  ← 新增     │
│  └──────────────────────────────┘             │
│                                                │
│     ┌───┐                    ┌───┐            │
│     │ ░ │                    │ ░ │            │
│     │ ░ │ 67250J             │ ░ │ 68050J     │
│     │ ░ │                    │ ░ │            │
│     └───┘                    └───┘            │
│   G1 (Proposed)            G4 (Baseline)      │
└────────────────────────────────────────────────┘
```

---

## 📐 数据完整性说明

### 实验数据

虽然箱线图只显示G1和G4,但实验仍然运行了所有4个组:

| 组别 | 实验运行 | JSON保存 | 箱线图显示 |
|------|---------|---------|-----------|
| G1 | ✅ | ✅ | ✅ |
| G2 | ✅ | ✅ | ❌ |
| G3 | ✅ | ✅ | ❌ |
| G4 | ✅ | ✅ | ✅ |

**原因**:
- 实验程序不变,仍运行4个组
- G2和G3数据保存在JSON结果中
- 可用于其他分析 (如雷达图、综合性能对比)

### 如需恢复4组显示

修改 `plot_boxplots_only.py` 第39行:

```python
# 恢复4组显示
groups = ['G1', 'G2', 'G3', 'G4']
group_labels = ['G1', 'G2', 'G3', 'G4']
```

---

## 📊 预期结果

### 统计指标

基于K=40, seeds=[27,37,41]的实验:

| 指标 | G1 (Proposed) | G4 (Baseline) | 改进 |
|------|--------------|--------------|------|
| 中位数 | ~67250J | ~68050J | 800J ↓ |
| 均值 | ~67252J | ~68055J | 803J ↓ |
| 标准差 | ~2J | ~3J | 更稳定 |
| IQR | 窄 | 稍宽 | G1更稳定 |
| **改进率** | - | - | **~1.18%** |

### 统计显著性

**Notch检验**:
- 如果G1和G4的notch(凹槽)不重叠 → 中位数差异在95%置信水平下显著
- 预期: G1和G4的notch应该**不重叠**,证明显著性

---

## 🎯 使用场景建议

### 适合使用G1 vs G4箱线图的场景

- ✅ **论文摘要图**: 快速传达核心贡献
- ✅ **演讲PPT**: 清晰的视觉对比
- ✅ **海报展示**: 突出核心结论
- ✅ **快速对比**: 与传统基线的直接比较
- ✅ **统计检验**: 证明显著性差异

### 适合使用4组完整对比的场景

- ✅ **详细分析章节**: 分析各因子的贡献
- ✅ **消融实验**: 说明算法1和算法2各自的作用
- ✅ **学术审稿**: 展示实验的完整性
- ✅ **方法对比**: 与多个基线方法对比

---

## ✅ 验证清单

### 代码修改

- [x] plot_boxplots_only.py 修改groups为['G1', 'G4']
- [x] 添加组别标签说明 (Proposed/Baseline)
- [x] 新增能耗降低百分比显示
- [x] 增强箱体和标注样式
- [x] 更新统计信息打印格式
- [x] 更新main函数的说明文本

### 文档修改

- [x] 箱线图实验设计说明.md 添加"对比组别"说明
- [x] 更新对照组表格,增加"箱线图显示"列
- [x] 添加箱线图选择理由
- [x] 更新实验矩阵和数据点表格
- [x] 更新预期结果说明
- [x] 创建本修改说明文档

### 实验验证

- [ ] 重新绘制箱线图 (待运行)
- [ ] 检查图表显示是否正确 (只有G1和G4)
- [ ] 验证改进率计算和显示 (待运行)
- [ ] 检查统计信息打印格式 (待运行)

---

## 🔄 如何运行

```bash
# 1. 确保已运行端到端实验(如果没有运行)
cd 端到端/核心代码
python run_experiment.py

# 2. 绘制箱线图 (新版,只显示G1和G4)
cd 端到端/对比实验
python plot_boxplots_only.py

# 3. 查看生成的图表
# 文件位置: 端到端/结果图表/distribution_boxplots.png
# 应该只显示2个箱体: 绿色(G1)和红色(G4)
# 顶部应显示能耗降低百分比
```

---

## 📚 参考文档

| 文档 | 路径 | 说明 |
|------|------|------|
| 绘图脚本 | `端到端/对比实验/plot_boxplots_only.py` | 箱线图生成脚本 |
| 实验设计 | `端到端/文档报告/箱线图实验设计说明.md` | 详细实验设计文档 |
| 能耗更新 | `端到端/文档报告/能耗计算更新说明.md` | 卫星能耗添加说明 |
| 本文档 | `端到端/文档报告/箱线图修改说明_G1vsG4.md` | 箱线图修改说明 |

---

## 💡 技术细节

### 为什么选择G1和G4?

1. **最大差异**: G1是最优,G4是最差,差异最明显
2. **对照清晰**: G1两个算法都优化,G4两个算法都不优化
3. **统计显著**: 差异大,更容易通过统计检验
4. **理论意义**: 展示端到端完整优化的价值

### 为什么不显示G2和G3?

- **G2 (P1 + Greedy)**: 只优化算法1,能耗与G1接近但略高
- **G3 (F-scheme + DA)**: 只优化算法2,但算法2对能耗影响小,与G4接近
- **干扰因素**: G2和G3的存在会让读者困惑"为什么有4个组?"
- **核心信息**: 我们的核心贡献是"端到端优化优于传统基线",不是"哪个单独算法更好"

### 改进率为什么只有1-2%?

**原因分析**:
```
系统总能耗 = E_UAV + E_IoT + E_satellite
             ≈ 7000J + 250J + 30000J = 67250J

算法1优化效果:
  E_UAV: 7000J (F-scheme) → 6200J (P1) = 降低800J

相对于总能耗:
  800J / 67000J ≈ 1.2%
```

**关键点**:
- 卫星能耗30000J占主导,且所有组相同
- UAV能耗优化800J相对总能耗较小
- 但**相对于UAV能耗本身**,改进率达11% (800/7000)

**论文写作建议**:
- 强调UAV能耗降低11%
- 说明卫星能耗是固定成本
- 突出在UAV可控部分的优化效果

---

## 📞 总结

本次修改将箱线图从显示4个组简化为只显示G1和G4,旨在:

1. **提高视觉清晰度** - 2个箱体比4个更直观
2. **突出核心对比** - 提出方法 vs 传统基线
3. **量化改进效果** - 显示能耗降低百分比
4. **增强统计显著性** - G1和G4差异最大

修改后的箱线图更适合用于论文摘要图、演讲和海报,能够快速传达研究的核心贡献。
